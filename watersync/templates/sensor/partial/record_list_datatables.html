<div class="filter-container">
    <div class="row mb-3">
        <div class="col-md-4">
            <label for="start-date">Start Date:</label>
            <input type="date" id="start-date" class="form-control">
        </div>
        <div class="col-md-4">
            <label for="end-date">End Date:</label>
            <input type="date" id="end-date" class="form-control">
        </div>
        <div class="col-md-4">
            <label for="measurement-type">Measurement Type:</label>
            <select id="measurement-type" class="form-select">
                <option value="">All</option>
                <option value="Flow rate">Flow rate</option>
                <option value="pressure">Pressure</option>
                <option value="temperature">Temperature</option>
                <option value="Volume">Volume</option>
            </select>
        </div>
    </div>
</div>

<table id="example" class="table table-striped nowrap" style="width:100%">
    <thead>
        <tr>
            <th>#</th>
            <th>Timestamp</th>
            <th>Value</th>
            <th>Unit</th>
            <th>Type</th>
        </tr>
    </thead>
    <tbody id="sensorrecord-list">
      {% for record in sensorrecord_list %}
      <tr>
        <th scope="row">{{ forloop.counter }}</th>
        <td>{{ record.timestamp }}</td>
        <td>{{ record.value }}</td>
        <td>{{ record.unit }}</td>
        <td>{{ record.type }}</td>
      </tr>
      {% endfor %}
    </tbody>
</table>


<script>
    $(document).ready(function() {
        // Initialize DataTable
        var table = $('#example').DataTable();
    
        // Custom filtering function for date range
        $.fn.dataTable.ext.search.push(
            function(settings, data, dataIndex) {
                var startDate = $('#start-date').val();
                var endDate = $('#end-date').val();
                var recordDate = data[1]; // Assuming 'Timestamp' is the second column in your table
    
                if (startDate) {
                    startDate = new Date(startDate);
                }
    
                if (endDate) {
                    endDate = new Date(endDate);
                }
    
                recordDate = new Date(recordDate);
    
                if (
                    (!startDate && !endDate) ||
                    (!startDate && recordDate <= endDate) ||
                    (startDate <= recordDate && !endDate) ||
                    (startDate <= recordDate && recordDate <= endDate)
                ) {
                    return true;
                }
                return false;
            }
        );
    
        // Custom filtering function for measurement type
        $.fn.dataTable.ext.search.push(
            function(settings, data, dataIndex) {
                var selectedType = $('#measurement-type').val();
                var recordType = data[4]; // Assuming 'Type' is the fifth column in your table
    
                if (!selectedType || selectedType === recordType) {
                    return true;
                }
                return false;
            }
        );
    
        // Event listeners to redraw the table when the filters are applied
        $('#start-date, #end-date, #measurement-type').on('change', function() {
            table.draw();
        });
    });
    </script>
    
